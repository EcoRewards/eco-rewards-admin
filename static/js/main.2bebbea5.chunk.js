(this["webpackJsonpeco-rewards-admin"]=this["webpackJsonpeco-rewards-admin"]||[]).push([[0],{49:function(e,t,a){e.exports=a(82)},54:function(e,t,a){},55:function(e,t,a){},57:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},82:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(35),s=a.n(c),l=(a(54),a(55),a(5)),i=a(11),o=a(2),m=a.n(o),u=a(4),d=a(1),b=(a(57),function(e){var t=e.auth,a=Object(i.g)(),c=(Object(i.h)().state||{from:{pathname:"/"}}).from,s=Object(n.useState)(""),l=Object(d.a)(s,2),o=l[0],b=l[1],p=Object(n.useState)(""),f=Object(d.a)(p,2),h=f[0],v=f[1],E=Object(n.useState)(""),g=Object(d.a)(E,2),O=g[0],N=g[1],y=Object(n.useState)(!0),w=Object(d.a)(y,2),j=w[0],k=w[1],x=function(){var e=Object(u.a)(m.a.mark((function e(n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,t.login(h,O);case 3:t.isAuthenticated?a.replace(c):b("Unable to login, please try again.");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return t.isAuthenticated&&a.replace(c),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-xl-10 col-lg-12 col-md-9"},r.a.createElement("div",{className:"card o-hidden border-0 shadow-lg my-5"},r.a.createElement("div",{className:"card-body p-0"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-6 d-none d-lg-block bg-login-image"}),r.a.createElement("div",{className:"col-lg-6"},r.a.createElement("div",{className:"p-5"},r.a.createElement("div",{className:"text-center"},r.a.createElement("h1",{className:"h4 text-gray-900 mb-4"},"Login")),r.a.createElement("form",{className:"user"},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"email",className:"form-control form-control-user",id:"exampleInputEmail","aria-describedby":"emailHelp",placeholder:"Enter Email Address...",onChange:function(e){return v(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",className:"form-control form-control-user",id:"exampleInputPassword",placeholder:"Password",onChange:function(e){return N(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"custom-control custom-checkbox small"},r.a.createElement("input",{type:"checkbox",checked:j,onChange:function(){return k(!j)},className:"custom-control-input",id:"customCheck"}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"customCheck"},"Remember Me"))),r.a.createElement("button",{className:"btn btn-primary btn-user btn-block",onClick:x},"Login")),o&&r.a.createElement("hr",null),o))))))))}),p=function(){return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h1",{className:"h3 mb-2 text-gray-800"},"Dashboard"),r.a.createElement("p",{className:"mb-4"},"This will be the dashboard page with a bit of information."))},f=(a(62),function(){return r.a.createElement("ul",{className:"navbar-nav bg-gradient-primary sidebar sidebar-dark accordion",id:"accordionSidebar"},r.a.createElement(l.b,{className:"sidebar-brand d-flex align-items-center justify-content-center",to:"/"},r.a.createElement("div",{className:"sidebar-brand-icon rotate-n-15"},r.a.createElement("i",{className:"fas fa-leaf"})),r.a.createElement("div",{className:"sidebar-brand-text mx-3"},"Eco Rewards Hub Admin")),r.a.createElement("hr",{className:"sidebar-divider my-0"}),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{exact:!0,activeClassName:"active",className:"nav-link",to:"/"},r.a.createElement("i",{className:"fas fa-fw fa-tachometer-alt"}),r.a.createElement("span",null,"Dashboard"))),r.a.createElement("hr",{className:"sidebar-divider"}),r.a.createElement("div",{className:"sidebar-heading"},"Manage"),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{activeClassName:"active",className:"nav-link",to:"/schemes"},r.a.createElement("i",{className:"fas fa-fw fa-city"}),r.a.createElement("span",null,"Schemes"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{activeClassName:"active",className:"nav-link",to:"/organisations"},r.a.createElement("i",{className:"fas fa-fw fa-school"}),r.a.createElement("span",null,"Organisations"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{activeClassName:"active",className:"nav-link",to:"/groups"},r.a.createElement("i",{className:"fas fa-fw fa-users"}),r.a.createElement("span",null,"Groups"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{activeClassName:"active",className:"nav-link",to:"/members"},r.a.createElement("i",{className:"fas fa-fw fa-user"}),r.a.createElement("span",null,"Members"))),r.a.createElement("hr",{className:"sidebar-divider"}),r.a.createElement("div",{className:"sidebar-heading"},"Reports"),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{activeClassName:"active",className:"nav-link",to:"/journeys"},r.a.createElement("i",{className:"fas fa-fw fa-bus"}),r.a.createElement("span",null,"Journeys"))))}),h=function(e){var t=e.auth;return r.a.createElement("nav",{className:"navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow"},r.a.createElement("button",{id:"sidebarToggleTop",className:"btn btn-link d-md-none rounded-circle mr-3"},r.a.createElement("i",{className:"fa fa-bars"})),r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item dropdown no-arrow"},r.a.createElement("a",{className:"dropdown-toggle",href:"/logout",onClick:function(e){e.preventDefault(),t.logout()},id:"userDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("span",{className:"mr-2 d-none d-lg-inline text-gray-600 small"},"Logout"),r.a.createElement("i",{className:"fas fa-user fa-sm fa-fw mr-2 text-gray-400"})))))},v=function(){return r.a.createElement("footer",{className:"sticky-footer bg-white"},r.a.createElement("div",{className:"container my-auto"},r.a.createElement("div",{className:"copyright text-center my-auto"},r.a.createElement("span",null,"Copyright \xa9 Eco Rewards"))))},E=a(13),g=function(e){var t=e.api,a=e.addScheme,c=Object(n.useState)(""),s=Object(d.a)(c,2),l=s[0],i=s[1],o=Object(n.useState)(""),b=Object(d.a)(o,2),p=b[0],f=b[1],h=function(){var e=Object(u.a)(m.a.mark((function e(n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,t.post("/scheme",{name:l});case 4:r=e.sent,i(""),f("Scheme created."),a(r.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),f("Error while creating scheme.");case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Create")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{className:"table-responsive",onSubmit:h,style:{maxWidth:"250px"}},r.a.createElement("p",null,p),r.a.createElement("table",{className:"table table-bordered",id:"dataTable"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:"name",value:l,onChange:function(e){return i(e.target.value)},className:"col-12"}))))),r.a.createElement("button",{style:{width:"100px"},type:"submit",className:"btn btn-primary btn-user btn-block",disabled:l.length<3},"Create"))))},O=a(37),N=a(38),y=a(39),w=a.n(y),j=a(20);a(63);function k(){var e=Object(N.a)(["\n  height: 32px;\n  width: 200px;\n  border-radius: 3px;\n  border-top-left-radius: 5px;\n  border-bottom-left-radius: 5px;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  border: 1px solid #e5e5e5;\n  padding: 0 32px 0 16px;\n\n  &:hover {\n    cursor: pointer;\n  }\n"]);return k=function(){return e},e}var x=function(e){var t=e.rows,a=e.columns,c=e.removeRows,s=e.api,l=Object(n.useState)([]),i=Object(d.a)(l,2),o=i[0],b=i[1],p=Object(n.useState)(!1),f=Object(d.a)(p,2),h=f[0],v=f[1],E=Object(n.useCallback)((function(e){b(e.selectedRows)}),[]),g=Object(n.useMemo)((function(){var e=function(){var e=Object(u.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete:\r ".concat(o.map((function(e){return e.name})),"?"))){e.next=5;break}return v(!h),e.next=4,Promise.all(o.map((function(e){return s.delete(e.id)})));case 4:c(o);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("button",{className:"btn btn-danger",key:"delete",onClick:e},"Delete")}),[o,h,s,c]),O=Object(n.useState)(""),N=Object(d.a)(O,2),y=N[0],j=N[1],k=Object(n.useState)(!1),x=Object(d.a)(k,1)[0],C=t.filter((function(e){return e.name&&e.name.includes(y)})),P=Object(n.useMemo)((function(){return r.a.createElement(S,{onFilter:function(e){return j(e.target.value)},filterText:y})}),[y]);return r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Edit")),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"table-responsive"},r.a.createElement(w.a,{columns:a,data:C,pagination:!0,paginationResetDefaultPage:x,subHeader:!0,subHeaderComponent:P,selectableRows:!0,contextActions:g,onSelectedRowsChange:E,clearSelectedRows:h}))))},S=function(e){var t=e.filterText,a=e.onFilter;e.onClear;return r.a.createElement(C,{id:"search",type:"text",placeholder:"Filter By Name",value:t,onChange:a})},C=j.default.input(k());function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var D=function(e){var t=e.api,a=e.schemes,n=e.removeSchemes,c=a.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){Object(E.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({numeric_id:Object(O.toSchemeId)(e.id)},e)}));return r.a.createElement(x,{columns:[{name:"ID",selector:"numeric_id",sortable:!0,width:"100px"},{name:"Name",selector:"name",sortable:!0}],rows:c,removeRows:n,api:t})};function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var R=function(e){var t=e.api,a=Object(n.useState)(),c=Object(d.a)(a,2),s=c[0],l=c[1],i=Object(n.useState)({}),o=Object(d.a)(i,2),b=o[0],p=o[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(m.a.mark((function e(){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/schemes");case 2:a=e.sent,l(a.data.data),p(a.data.links);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s||function(){e.apply(this,arguments)}()}),[t,s]);return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h1",{className:"h3 mb-2 text-gray-800"},"Schemes"),r.a.createElement("p",{className:"mb-4"},"Create and manage schemes."),r.a.createElement(g,{api:t,addScheme:function(e){s.push(e.data),l(s),p(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(Object(a),!0).forEach((function(t){Object(E.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e.links,{},b))}}),r.a.createElement(D,{api:t,schemes:s||[],removeSchemes:function(e){l(s.filter((function(t){return!e.some((function(e){return t.id===e.id}))})))}}))},I=function(e){var t=e.api,a=e.addOrganisation,c=e.schemes,s=Object(n.useState)(""),l=Object(d.a)(s,2),i=l[0],o=l[1],b=Object(n.useState)(""),p=Object(d.a)(b,2),f=p[0],h=p[1],v=Object(n.useState)(""),E=Object(d.a)(v,2),g=E[0],O=E[1],N=function(){var e=Object(u.a)(m.a.mark((function e(n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,t.post("/organisation",{name:i,scheme:f});case 4:r=e.sent,o(""),O("Organisation created."),a(r.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),O("Error while creating organisation.");case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Create")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{className:"table-responsive",onSubmit:N,style:{maxWidth:"400px"}},r.a.createElement("p",null,g),r.a.createElement("table",{className:"table table-bordered",id:"dataTable"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Scheme"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:"name",value:i,onChange:function(e){return o(e.target.value)},className:"col-12"})),r.a.createElement("td",null,r.a.createElement("select",{name:"scheme",onChange:function(e){return h(e.target.value)}},r.a.createElement("option",{value:""},"<Select scheme>"),c.map((function(e){return r.a.createElement(T,{key:e.id,scheme:e})}))))))),r.a.createElement("button",{style:{width:"100px"},type:"submit",className:"btn btn-primary btn-user btn-block",disabled:i.length<3||""===f},"Create"))))},T=function(e){var t=e.scheme;return r.a.createElement("option",{value:t.id},t.name)},L=a(42),M=function(e){var t=e.api,a=e.organisations,n=e.links,c=e.removeOrganisations,s=a.map((function(e){return{id:e.id,numeric_id:Object(L.toOrganisationId)(e.id),name:e.name,scheme:n[e.scheme].name}}));return r.a.createElement(x,{columns:[{name:"ID",selector:"numeric_id",sortable:!0,width:"100px"},{name:"Name",selector:"name",sortable:!0},{name:"Scheme",selector:"scheme",sortable:!0}],rows:s,api:t,removeRows:c})};function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){Object(E.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var H=function(e){var t=e.api,a=Object(n.useState)(),c=Object(d.a)(a,2),s=c[0],l=c[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(m.a.mark((function e(){var a,n,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.get("/organisations").then((function(e){return e.data})),t.get("/schemes").then((function(e){return e.data}))]);case 2:a=e.sent,n=Object(d.a)(a,2),r=n[0],c=n[1],l({organisations:r,schemes:c});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s||function(){e.apply(this,arguments)}()}),[t,s]);return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h1",{className:"h3 mb-2 text-gray-800"},"Organisations"),r.a.createElement("p",{className:"mb-4"},"Create and manage organisations."),r.a.createElement(I,{api:t,addOrganisation:function(e){s.organisations.data.push(e.data),s.organisations.links=F({},e.links,{},s.organisations.links),l(F({},s))},schemes:s?s.schemes.data:[]}),r.a.createElement(M,{api:t,removeOrganisations:function(e){s.organisations.data=s.organisations.data.filter((function(t){return!e.some((function(e){return t.id===e.id}))})),l(F({},s))},organisations:s?s.organisations.data:[],links:s?s.organisations.links:{}}))},U=function(e){var t=e.auth;return r.a.createElement("div",{id:"wrapper"},r.a.createElement(f,null),r.a.createElement("div",{id:"content-wrapper",className:"d-flex flex-column"},r.a.createElement("div",{id:"content"},r.a.createElement(h,{auth:t}),r.a.createElement(l.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/schemes"},r.a.createElement(R,{api:t.getAuthenticatedApi()})),r.a.createElement(i.b,{path:"/organisations"},r.a.createElement(H,{api:t.getAuthenticatedApi()})),r.a.createElement(i.b,{path:"/"},r.a.createElement(p,null))))),r.a.createElement(v,null)))},W=a(43),_=function(e){var t=e.children,a=e.auth,n=Object(W.a)(e,["children","auth"]);return r.a.createElement(i.b,Object.assign({},n,{render:function(e){var n=e.location;return a.isAuthenticated?t:r.a.createElement(i.a,{to:{pathname:"/login",state:{from:n}}})}}))},J=a(44),z=a(45),G=a(46),$=a(16),q=a.n($),K=function(){function e(t){Object(J.a)(this,e),this.api=t,this.cookie=void 0,this.setCookie=void 0,this.removeCookie=void 0,this.authenticatedApi=void 0;var a=Object(G.a)(["auth"]),n=Object(d.a)(a,3),r=n[0],c=n[1],s=n[2];this.cookie=r.auth,this.setCookie=c,this.removeCookie=s,this.authenticatedApi=q.a.create({baseURL:t.defaults.baseURL,headers:{authorization:"Basic "+(this.cookie&&this.cookie.token)}})}return Object(z.a)(e,[{key:"login",value:function(){var e=Object(u.a)(m.a.mark((function e(t,a){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.post("/login",{username:t,password:a});case 3:n=e.sent,this.setCookie("auth",n.data.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.removeCookie("auth")}},{key:"getAuthenticatedApi",value:function(){return this.authenticatedApi}},{key:"isAuthenticated",get:function(){return this.cookie&&void 0!==this.cookie.token}}]),e}();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(80),a(81);s.a.render(r.a.createElement((function(){var e=new K(q.a.create({baseURL:"https://api.ecorewards.co.uk"}));return r.a.createElement(l.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/login"},r.a.createElement(b,{auth:e})),r.a.createElement(_,{auth:e,path:"/"},r.a.createElement(U,{auth:e}))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[49,1,2]]]);
//# sourceMappingURL=main.2bebbea5.chunk.js.map