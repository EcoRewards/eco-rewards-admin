(this["webpackJsonpeco-rewards-admin"]=this["webpackJsonpeco-rewards-admin"]||[]).push([[0],{223:function(e,t,a){e.exports=a(452)},228:function(e,t,a){},229:function(e,t,a){},231:function(e,t,a){},422:function(e,t,a){},423:function(e,t,a){},448:function(e,t,a){},449:function(e,t,a){},452:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(35),s=a.n(c),l=(a(228),a(229),a(14)),o=a(10),i=a(3),m=a.n(i),u=a(7),d=a(1),p=(a(231),function(e){var t=e.auth,a=Object(o.g)(),c=(Object(o.h)().state||{from:{pathname:"/"}}).from,s=Object(n.useState)(""),l=Object(d.a)(s,2),i=l[0],p=l[1],b=Object(n.useState)(""),f=Object(d.a)(b,2),h=f[0],v=f[1],E=Object(n.useState)(""),g=Object(d.a)(E,2),O=g[0],y=g[1],j=Object(n.useState)(!0),w=Object(d.a)(j,2),N=w[0],x=w[1],k=function(){var e=Object(u.a)(m.a.mark((function e(n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,t.login(h,O);case 3:t.isAuthenticated?a.replace(c):p("Unable to login, please try again.");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return t.isAuthenticated&&a.replace(c),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-xl-10 col-lg-12 col-md-9"},r.a.createElement("div",{className:"card o-hidden border-0 shadow-lg my-5"},r.a.createElement("div",{className:"card-body p-0"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-6 d-none d-lg-block bg-login-image"}),r.a.createElement("div",{className:"col-lg-6"},r.a.createElement("div",{className:"p-5"},r.a.createElement("div",{className:"text-center"},r.a.createElement("h1",{className:"h4 text-gray-900 mb-4"},"Login")),r.a.createElement("form",{className:"user"},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"email",className:"form-control form-control-user",id:"exampleInputEmail","aria-describedby":"emailHelp",placeholder:"Enter Email Address...",onChange:function(e){return v(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",className:"form-control form-control-user",id:"exampleInputPassword",placeholder:"Password",onChange:function(e){return y(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement("div",{className:"custom-control custom-checkbox small"},r.a.createElement("input",{type:"checkbox",checked:N,onChange:function(){return x(!N)},className:"custom-control-input",id:"customCheck"}),r.a.createElement("label",{className:"custom-control-label",htmlFor:"customCheck"},"Remember Me"))),r.a.createElement("button",{className:"btn btn-primary btn-user btn-block",onClick:k},"Login")),i&&r.a.createElement("hr",null),i))))))))}),b=a(27),f=["#ffc658","#8884d8","#82ca9d"],h=function(e){var t=e.title,a=e.names,n=e.data,c=a.map((function(e,t){return r.a.createElement(b.a,{key:t,dataKey:e,fill:f[t%f.length]})}));return r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},t)),r.a.createElement("div",{className:"card-body"},n&&0!==n.length?r.a.createElement(b.e,{width:"99%",height:500},r.a.createElement(b.b,{data:n,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(b.c,{strokeDasharray:"3 3"}),r.a.createElement(b.g,{dataKey:"date"}),r.a.createElement(b.h,null),r.a.createElement(b.f,null),r.a.createElement(b.d,null),c)):r.a.createElement("p",null,"No data.")))},v=function(e){e.groups;var t=e.links,a=e.onChange,c=Object(n.useState)(""),s=Object(d.a)(c,2),l=s[0],o=s[1],i=Object.keys(t).filter((function(e){return e.startsWith("/scheme/")&&"/scheme/1"!==e})).map((function(e){return t[e]})),m=Object.keys(t).filter((function(e){return e.startsWith("/organisation/")&&t[e].scheme===l})).map((function(e){return t[e]}));return r.a.createElement("div",{className:"group-select"},r.a.createElement("select",{className:"col-3 custom-select form-control form-control-sm mr-3",name:"scheme",onChange:function(e){return t=o,n=e.target.value,t(n),void a(n);var t,n}},r.a.createElement("option",{value:""},"All schemes"),i.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}))),r.a.createElement("select",{disabled:0===m.length,className:"col-3 custom-select form-control form-control-sm",name:"organisation",onChange:function(e){return a(e.target.value||l)}},r.a.createElement("option",{value:""},"All organisations"),m.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}))))},E=a(183),g=function(e){for(var t=e.onChange,a=E.a.now(),n={"Last 7 days":[a.minusDays(7),a],"Last 30 days":[a.minusDays(30),a],"This month":[a.withDayOfMonth(1),a]},c=1;c<=6;c++){var s=a.minusMonths(c);n[s.month().name()]=[s.withDayOfMonth(1),s.plusMonths(1).withDayOfMonth(1).minusDays(1)]}return r.a.createElement("select",{className:"custom-select form-control form-control-sm",onChange:function(e){return t(e.target.value)}},Object.entries(n).map((function(e){var t=Object(d.a)(e,2),a=t[0],n=Object(d.a)(t[1],2),c=n[0],s=n[1];return r.a.createElement("option",{key:a,value:c.toJSON()+","+s.toJSON()},a.charAt(0)+a.slice(1).toLowerCase())})))},O=function(e){var t=e.api,a=Object(n.useState)("/global/0/report"),c=Object(d.a)(a,2),s=c[0],l=c[1],o=Object(n.useState)(),i=Object(d.a)(o,2),p=i[0],b=i[1],f=Object(n.useState)(),E=Object(d.a)(f,2),O=E[0],y=E[1],j=Object(n.useState)(),w=Object(d.a)(j,2),N=w[0],x=w[1],k=Object(n.useState)(),S=Object(d.a)(k,2),C=S[0],D=S[1],P=Object(n.useState)([]),M=Object(d.a)(P,2),T=M[0],R=M[1],A=Object(n.useState)({}),L=Object(d.a)(A,2),I=L[0],U=L[1],W=Object(n.useState)(),G=Object(d.a)(W,2),F=G[0],_=G[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(m.a.mark((function e(){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/groups");case 2:a=e.sent,R(a.data.data),U(a.data.links);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}0===T.length&&function(){e.apply(this,arguments)}()}),[t,T]),Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(m.a.mark((function e(){var a,n,r,c,l,o,i,u,d,p,f,h;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=F?"?from="+F.split(",").join("&to="):"",e.next=3,t.get(s+a);case 3:for(n=e.sent,r={},c={},l={},o={},i=!0,u=!1,d=void 0,e.prev=11,p=n.data.data[Symbol.iterator]();!(i=(f=p.next()).done);i=!0)h=f.value,r[h.date]=r[h.date]||{date:h.date},r[h.date][h.name]=h.totalCarbonSaving,l[h.date]=l[h.date]||{date:h.date},l[h.date][h.name]=h.totalDistance,c[h.date]=c[h.date]||{date:h.date},c[h.date][h.name]=h.totalRewardsEarned,o[h.name]=!0;e.next=19;break;case 15:e.prev=15,e.t0=e.catch(11),u=!0,d=e.t0;case 19:e.prev=19,e.prev=20,i||null==p.return||p.return();case 22:if(e.prev=22,!u){e.next=25;break}throw d;case 25:return e.finish(22);case 26:return e.finish(19);case 27:b(Object.keys(o)),y(Object.values(r)),D(Object.values(l)),x(Object.values(c));case 31:case"end":return e.stop()}}),e,null,[[11,15,19,27],[20,,22,26]])})))).apply(this,arguments)}p||function(){e.apply(this,arguments)}()}),[t,p,s,F]);return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h1",{className:"h3 mb-2 text-gray-800"},"Dashboard"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-9"},r.a.createElement(v,{groups:T,links:I,onChange:function(e){l(e?e+"/report":"/global/0/report"),b(null)}})),r.a.createElement("div",{className:"col-3"},r.a.createElement(g,{onChange:function(e){_(e),b(null)}}))),p?r.a.createElement(r.a.Fragment,null,r.a.createElement(h,{key:"rewards",title:"Rewards Earned",data:N,names:p}),r.a.createElement(h,{key:"carbon",title:"Carbon Saving",data:O,names:p}),r.a.createElement(h,{key:"distance",title:"Distance",data:C,names:p})):r.a.createElement("p",null,"Loading"))},y=(a(422),function(){return r.a.createElement("ul",{className:"navbar-nav bg-gradient-primary sidebar sidebar-dark accordion",id:"accordionSidebar"},r.a.createElement(l.b,{className:"sidebar-brand d-flex align-items-center justify-content-center",to:"/"},r.a.createElement("div",{className:"sidebar-brand-icon rotate-n-15"},r.a.createElement("i",{className:"fas fa-leaf"})),r.a.createElement("div",{className:"sidebar-brand-text mx-3"},"Eco Rewards Hub Admin")),r.a.createElement("hr",{className:"sidebar-divider my-0"}),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{exact:!0,activeClassName:"active",className:"nav-link",to:"/"},r.a.createElement("i",{className:"fas fa-fw fa-tachometer-alt"}),r.a.createElement("span",null,"Dashboard"))),r.a.createElement("hr",{className:"sidebar-divider"}),r.a.createElement("div",{className:"sidebar-heading"},"Manage"),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{activeClassName:"active",className:"nav-link",to:"/schemes"},r.a.createElement("i",{className:"fas fa-fw fa-city"}),r.a.createElement("span",null,"Schemes"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{activeClassName:"active",className:"nav-link",to:"/organisations"},r.a.createElement("i",{className:"fas fa-fw fa-school"}),r.a.createElement("span",null,"Organisations"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{activeClassName:"active",className:"nav-link",to:"/groups"},r.a.createElement("i",{className:"fas fa-fw fa-users"}),r.a.createElement("span",null,"Groups"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{activeClassName:"active",className:"nav-link",to:"/members"},r.a.createElement("i",{className:"fas fa-fw fa-user"}),r.a.createElement("span",null,"Members"))),r.a.createElement("hr",{className:"sidebar-divider"}),r.a.createElement("div",{className:"sidebar-heading"},"Reports"),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{activeClassName:"active",className:"nav-link",to:"/journeys"},r.a.createElement("i",{className:"fas fa-fw fa-bus"}),r.a.createElement("span",null,"Journeys"))),r.a.createElement("li",{className:"nav-item"},r.a.createElement(l.b,{activeClassName:"active",className:"nav-link",to:"/devices"},r.a.createElement("i",{className:"fas fa-fw fa-bus"}),r.a.createElement("span",null,"Device Status"))))}),j=function(e){var t=e.auth;return r.a.createElement("nav",{className:"navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow"},r.a.createElement("span",{className:"text-gray-600 small"},"Welcome back, ",t.getName()),r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item dropdown no-arrow"},r.a.createElement("a",{className:"dropdown-toggle",href:"/logout",onClick:function(e){e.preventDefault(),t.logout()},id:"userDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},r.a.createElement("span",{className:"mr-2 d-none d-lg-inline text-gray-600 small"},"Logout"),r.a.createElement("i",{className:"fas fa-user fa-sm fa-fw mr-2 text-gray-400"})))))},w=function(){return r.a.createElement("footer",{className:"sticky-footer bg-white"},r.a.createElement("div",{className:"container my-auto"},r.a.createElement("div",{className:"copyright text-center my-auto"},r.a.createElement("span",null,"Copyright \xa9 Eco Rewards"))))},N=a(19),x=function(e){var t=e.api,a=e.addScheme,c=Object(n.useState)(""),s=Object(d.a)(c,2),l=s[0],o=s[1],i=Object(n.useState)("0"),p=Object(d.a)(i,2),b=p[0],f=p[1],h=Object(n.useState)(""),v=Object(d.a)(h,2),E=v[0],g=v[1],O=function(){var e=Object(u.a)(m.a.mark((function e(n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,t.post("/scheme",{name:l,vacClientId:+b});case 4:r=e.sent,o(""),f("0"),g("Scheme created."),a(r.data),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),g("Error while creating scheme.");case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Create")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{className:"table-responsive",onSubmit:O,style:{maxWidth:"450px"}},r.a.createElement("p",null,E),r.a.createElement("table",{className:"table table-bordered",id:"dataTable"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"VAC Client ID"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:"name",value:l,onChange:function(e){return o(e.target.value)},className:"col-12"})),r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:"vacClientId",value:b,onChange:function(e){return f(e.target.value)},className:"col-12"}))))),r.a.createElement("button",{style:{width:"100px"},type:"submit",className:"btn btn-primary btn-user btn-block",disabled:l.length<3},"Create"))))},k=a(184),S=a(185),C=a(186),D=a.n(C),P=a(100);a(423);function M(){var e=Object(S.a)(["\n  height: 32px;\n  width: 200px;\n  border-radius: 3px;\n  border-top-left-radius: 5px;\n  border-bottom-left-radius: 5px;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  border: 1px solid #e5e5e5;\n  padding: 0 32px 0 16px;\n\n  &:hover {\n    cursor: pointer;\n  }\n"]);return M=function(){return e},e}var T=function(e){var t=e.rows,a=e.columns,c=e.removeRows,s=e.editRow,l=e.api,o=Object(n.useState)([]),i=Object(d.a)(o,2),p=i[0],b=i[1],f=Object(n.useState)(!1),h=Object(d.a)(f,2),v=h[0],E=h[1],g=Object(n.useCallback)((function(e){b(e.selectedRows)}),[]),O=Object(n.useMemo)((function(){var e=function(){var e=Object(u.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete:\r ".concat(p.map((function(e){return e.name})),"?"))){e.next=5;break}return E(!v),e.next=4,Promise.all(p.map((function(e){return l.delete(e.id)})));case 4:c(p);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=r.a.createElement("button",{className:"btn btn-danger",key:"delete",onClick:e},"Delete"),a=s&&1===p.length?r.a.createElement("button",{className:"btn btn-primary",key:"edit",onClick:function(){return s(p[0])}},"Edit"):null;return r.a.createElement(r.a.Fragment,null,a," ",t)}),[p,v,l,c,s]),y=Object(n.useState)(""),j=Object(d.a)(y,2),w=j[0],N=j[1],x=Object(n.useState)(!1),k=Object(d.a)(x,1)[0],S=t.filter((function(e){return e.name&&e.name.includes(w)||e.id===w})),C=Object(n.useMemo)((function(){return r.a.createElement(R,{onFilter:function(e){return N(e.target.value)},filterText:w})}),[w]);return r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Edit")),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"table-responsive"},r.a.createElement(D.a,{columns:a,data:S,pagination:!0,paginationResetDefaultPage:k,paginationPerPage:30,subHeader:!0,subHeaderComponent:C,selectableRows:!0,contextActions:c?O:void 0,onSelectedRowsChange:g,clearSelectedRows:v}))))},R=function(e){var t=e.filterText,a=e.onFilter;e.onClear;return r.a.createElement(A,{id:"search",type:"text",placeholder:"Filter By Name",value:t,onChange:a})},A=P.default.input(M());function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var I=function(e){var t=e.api,a=e.schemes,n=e.removeSchemes,c=a.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(Object(a),!0).forEach((function(t){Object(N.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({numeric_id:Object(k.toSchemeId)(e.id)},e)}));return r.a.createElement(T,{columns:[{name:"ID",selector:"numeric_id",sortable:!0,width:"100px"},{name:"Name",selector:"name",sortable:!0},{name:"VAC Client ID",selector:"vacClientId",sortable:!0}],rows:c,removeRows:n,api:t})};function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var W=function(e){var t=e.api,a=Object(n.useState)(),c=Object(d.a)(a,2),s=c[0],l=c[1],o=Object(n.useState)({}),i=Object(d.a)(o,2),p=i[0],b=i[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(m.a.mark((function e(){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/schemes");case 2:a=e.sent,l(a.data.data),b(a.data.links);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s||function(){e.apply(this,arguments)}()}),[t,s]);return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h1",{className:"h3 mb-2 text-gray-800"},"Schemes"),r.a.createElement("p",{className:"mb-4"},"Create and manage schemes."),r.a.createElement(x,{api:t,addScheme:function(e){s.push(e.data),l(s),b(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(Object(a),!0).forEach((function(t){Object(N.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e.links,{},p))}}),r.a.createElement(I,{api:t,schemes:s||[],removeSchemes:function(e){l(s.filter((function(t){return!e.some((function(e){return t.id===e.id}))})))}}))},G=function(e){var t=e.api,a=e.addOrganisation,c=e.schemes,s=Object(n.useState)(""),l=Object(d.a)(s,2),o=l[0],i=l[1],p=Object(n.useState)(""),b=Object(d.a)(p,2),f=b[0],h=b[1],v=Object(n.useState)(""),E=Object(d.a)(v,2),g=E[0],O=E[1],y=function(){var e=Object(u.a)(m.a.mark((function e(n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,t.post("/organisation",{name:o,scheme:f});case 4:r=e.sent,i(""),O("Organisation created."),a(r.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),O("Error while creating organisation.");case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Create")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{className:"table-responsive",onSubmit:y,style:{maxWidth:"400px"}},r.a.createElement("p",null,g),r.a.createElement("table",{className:"table table-bordered",id:"dataTable"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Scheme"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:"name",value:o,onChange:function(e){return i(e.target.value)},className:"col-12"})),r.a.createElement("td",null,r.a.createElement("select",{name:"scheme",onChange:function(e){return h(e.target.value)}},r.a.createElement("option",{value:""},"<Select scheme>"),c.map((function(e){return r.a.createElement(F,{key:e.id,scheme:e})}))))))),r.a.createElement("button",{style:{width:"100px"},type:"submit",className:"btn btn-primary btn-user btn-block",disabled:o.length<3||""===f},"Create"))))},F=function(e){var t=e.scheme;return r.a.createElement("option",{value:t.id},t.name)},_=a(190),V=function(e){var t=e.api,a=e.organisations,n=e.links,c=e.removeOrganisations,s=a.map((function(e){return{id:e.id,numeric_id:Object(_.toOrganisationId)(e.id),name:e.name,scheme:n[e.scheme].name}}));return r.a.createElement(T,{columns:[{name:"ID",selector:"numeric_id",sortable:!0,width:"100px"},{name:"Name",selector:"name",sortable:!0},{name:"Scheme",selector:"scheme",sortable:!0}],rows:s,api:t,removeRows:c})};function J(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function B(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?J(Object(a),!0).forEach((function(t){Object(N.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var H=function(e){var t=e.api,a=Object(n.useState)(),c=Object(d.a)(a,2),s=c[0],l=c[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(m.a.mark((function e(){var a,n,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.get("/organisations").then((function(e){return e.data})),t.get("/schemes").then((function(e){return e.data}))]);case 2:a=e.sent,n=Object(d.a)(a,2),r=n[0],c=n[1],l({organisations:r,schemes:c});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s||function(){e.apply(this,arguments)}()}),[t,s]);return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h1",{className:"h3 mb-2 text-gray-800"},"Organisations"),r.a.createElement("p",{className:"mb-4"},"Create and manage organisations."),r.a.createElement(G,{api:t,addOrganisation:function(e){s.organisations.data.push(e.data),s.organisations.links=B({},e.links,{},s.organisations.links),l(B({},s))},schemes:s?s.schemes.data:[]}),r.a.createElement(V,{api:t,removeOrganisations:function(e){s.organisations.data=s.organisations.data.filter((function(t){return!e.some((function(e){return t.id===e.id}))})),l(B({},s))},organisations:s?s.organisations.data:[],links:s?s.organisations.links:{}}))},q=function(e){var t=e.api,a=e.addGroup,c=e.organisations,s=Object(n.useState)(""),l=Object(d.a)(s,2),o=l[0],i=l[1],p=Object(n.useState)(""),b=Object(d.a)(p,2),f=b[0],h=b[1],v=Object(n.useState)(""),E=Object(d.a)(v,2),g=E[0],O=E[1],y=function(){var e=Object(u.a)(m.a.mark((function e(n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,t.post("/group",{name:o,organisation:f});case 4:r=e.sent,i(""),O("Group created."),a(r.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),O("Error while creating group.");case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Create")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{className:"table-responsive",onSubmit:y,style:{maxWidth:"400px"}},r.a.createElement("p",null,g),r.a.createElement("table",{className:"table table-bordered",id:"dataTable"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Organisation"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:"name",value:o,onChange:function(e){return i(e.target.value)},className:"col-12"})),r.a.createElement("td",null,r.a.createElement("select",{name:"organisation",onChange:function(e){return h(e.target.value)}},r.a.createElement("option",{value:""},"<Select organisation>"),c.map((function(e){return r.a.createElement(z,{key:e.id,organisation:e})}))))))),r.a.createElement("button",{style:{width:"100px"},type:"submit",className:"btn btn-primary btn-user btn-block",disabled:o.length<3||""===f},"Create"))))},z=function(e){var t=e.organisation;return r.a.createElement("option",{value:t.id},t.name)},K=a(191),$=function(e){var t=e.api,a=e.groups,n=e.links,c=e.removeGroups,s=a.map((function(e){return{id:e.id,numeric_id:Object(K.toGroupId)(e.id),name:e.name,organisation:n[e.organisation].name}}));return r.a.createElement(T,{columns:[{name:"ID",selector:"numeric_id",sortable:!0,width:"100px"},{name:"Name",selector:"name",sortable:!0},{name:"Organisation",selector:"organisation",sortable:!0}],rows:s,api:t,removeRows:c})};function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){Object(N.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var X=function(e){var t=e.api,a=Object(n.useState)(),c=Object(d.a)(a,2),s=c[0],l=c[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(m.a.mark((function e(){var a,n,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.get("/groups").then((function(e){return e.data})),t.get("/organisations").then((function(e){return e.data}))]);case 2:a=e.sent,n=Object(d.a)(a,2),r=n[0],c=n[1],l({groups:r,organisations:c});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s||function(){e.apply(this,arguments)}()}),[t,s]);return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h1",{className:"h3 mb-2 text-gray-800"},"Groups"),r.a.createElement("p",{className:"mb-4"},"Create and manage groups."),r.a.createElement(q,{api:t,addGroup:function(e){s.groups.data.push(e.data),s.groups.links=Y({},e.links,{},s.groups.links),l(Y({},s))},organisations:s?s.organisations.data:[]}),r.a.createElement($,{api:t,removeGroups:function(e){s.groups.data=s.groups.data.filter((function(t){return!e.some((function(e){return t.id===e.id}))})),l(Y({},s))},groups:s?s.groups.data:[],links:s?s.groups.links:{}}))},Z=function(e){var t=e.defaultTransportMode,a=e.setDefaultTransportMode;return r.a.createElement("select",{className:"custom-select custom-select-sm form-control form-control-sm",name:"defaultTransportMode",defaultValue:t,onChange:function(e){return a(e.target.value)}},r.a.createElement("option",{value:""},"Select green transport mode"),["Car share","Large car","Medium car","Small car","Electric car","Taxi","Park and ride","Tram","Bus","Train","Cycling","Walk","Work from home"].map((function(e,t){return r.a.createElement("option",{key:t,value:e.toLowerCase()},e)})))},ee=function(e){var t=e.api,a=e.addMembers,c=e.groups,s=Object(n.useState)(""),l=Object(d.a)(s,2),o=l[0],i=l[1],p=Object(n.useState)(""),b=Object(d.a)(p,2),f=b[0],h=b[1],v=Object(n.useState)("0.00"),E=Object(d.a)(v,2),g=E[0],O=E[1],y=Object(n.useState)("10"),j=Object(d.a)(y,2),w=j[0],N=j[1],x=Object(n.useState)(""),k=Object(d.a)(x,2),S=k[0],C=k[1],D=function(){var e=Object(u.a)(m.a.mark((function e(n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,t.post("/members",{group:o,defaultTransportMode:f,defaultDistance:+g,quantity:+w});case 4:r=e.sent,O("0.00"),C(w+" new members created."),N("10"),a(r.data),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),C("Error while creating members.");case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),P=o.length>2&&+w>0;return r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Create")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{className:"table-responsive",onSubmit:D,style:{maxWidth:"650px"}},r.a.createElement("p",null,S),r.a.createElement("table",{className:"table table-bordered",id:"dataTable"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Group"),r.a.createElement("th",null,"Default Mode"),r.a.createElement("th",null,"Default Distance"),r.a.createElement("th",null,"Quantity"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("select",{className:"custom-select custom-select-sm form-control form-control-sm",name:"group",onChange:function(e){return i(e.target.value)}},r.a.createElement("option",{value:""},"<Select group>"),c.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)})))),r.a.createElement("td",null,r.a.createElement(Z,{defaultTransportMode:f,setDefaultTransportMode:h})),r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:"defaultDistance",value:g,onChange:function(e){return O(e.target.value)},className:"col-12"})),r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:"quantity",value:w,onChange:function(e){return N(e.target.value)},className:"col-12"}))))),r.a.createElement("button",{style:{width:"100px"},type:"submit",className:"btn btn-primary btn-user btn-block",disabled:!P},"Create"))))},te=a(104),ae=a.n(te);ae.a.setAppElement("#root");var ne={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",border:"none",background:"none"},overlay:{zIndex:2,backgroundColor:"rgba(150,150,150, 0.65)"}},re=function(e){var t=e.api,a=e.members,n=e.links,c=e.removeMembers,s=e.groups,l=a.map((function(e){return{id:e.id,numeric_id:e.id.substr(8),name:n[e.group].name,group:e.group,defaultTransportMode:e.defaultTransportMode,defaultDistance:e.defaultDistance+" miles",previousTransportMode:e.previousTransportMode,totalMiles:e.totalMiles+" miles",carbonSaving:e.carbonSaving+"kg",rewards:e.rewards,organisation:n[n[e.group].organisation].name,scheme:n[n[n[e.group].organisation].scheme].name}})),o=r.a.useState(),i=Object(d.a)(o,2),p=i[0],b=i[1],f=r.a.useState(),h=Object(d.a)(f,2),v=h[0],E=h[1],g=r.a.useState(),O=Object(d.a)(g,2),y=O[0],j=O[1],w=r.a.useState(),N=Object(d.a)(w,2),x=N[0],k=N[1],S=r.a.useState(),C=Object(d.a)(S,2),D=C[0],P=C[1],M=r.a.useState(),R=Object(d.a)(M,2),A=R[0],L=R[1],I=function(){window.location.reload()},U=function(){var e=Object(u.a)(m.a.mark((function e(n){var r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,r={group:A,defaultTransportMode:y,previousTransportMode:x,defaultDistance:+D},e.next=5,t.put(p.id,r);case 5:c=a.find((function(e){return e.id===p.id})),Object.assign(c,r),b(null),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),E("Error while updating.");case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{columns:[{name:"ID",selector:"numeric_id",sortable:!0,width:"175px"},{name:"Scheme",selector:"scheme",sortable:!0},{name:"Organisation",selector:"organisation",sortable:!0},{name:"Group",selector:"name",sortable:!0},{name:"Default Mode",selector:"defaultTransportMode",sortable:!1,width:"140px"},{name:"Previous Mode",selector:"previousTransportMode",sortable:!1,width:"140px"},{name:"Default Distance",selector:"defaultDistance",sortable:!0,width:"130px"},{name:"Rewards",selector:"rewards",sortable:!0,width:"90px"},{name:"Carbon Saving",selector:"carbonSaving",sortable:!0,width:"130px"},{name:"Total Miles",selector:"totalMiles",sortable:!0,width:"130px"}],rows:l,api:t,removeRows:c,editRow:function(e){b(e),P(+e.defaultDistance.replace(" miles","")),j(e.defaultTransportMode),k(e.previousTransportMode),L(e.group)}}),r.a.createElement(ae.a,{style:ne,isOpen:!!p,onRequestClose:I,contentLabel:"Edit Member"},r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Edit Member")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{className:"table-responsive",onSubmit:U,style:{maxWidth:"650px"}},r.a.createElement("p",null,v),r.a.createElement("table",{className:"table table-bordered",id:"dataTable"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Group"),r.a.createElement("td",null,r.a.createElement("select",{className:"custom-select custom-select-sm form-control form-control-sm",name:"group",onChange:function(e){return L(e.target.value)},defaultValue:A},s.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}))))),r.a.createElement("tr",null,r.a.createElement("td",null,"Default Transport Mode"),r.a.createElement("td",null,r.a.createElement(Z,{defaultTransportMode:y,setDefaultTransportMode:j}))),r.a.createElement("tr",null,r.a.createElement("td",null,"Previous Transport Mode"),r.a.createElement("td",null,r.a.createElement(Z,{defaultTransportMode:x,setDefaultTransportMode:k}))),r.a.createElement("tr",null,r.a.createElement("td",null,"Default Distance"),r.a.createElement("td",null,r.a.createElement("input",{type:"text",name:"defaultDistance",value:D,onChange:function(e){return P(e.target.value)},className:"col-12"}))))),r.a.createElement("div",{className:"container row pl-3 pr-0"},r.a.createElement("div",{className:"col-6 p-0"},r.a.createElement("input",{type:"button",value:"Cancel",style:{width:"100px"},className:"btn btn-light btn-user btn-block",onClick:I})),r.a.createElement("div",{className:"col-6 p-0"},r.a.createElement("button",{style:{width:"100px",float:"right"},type:"submit",className:"btn btn-primary btn-user btn-block"},"Update"))))))))};function ce(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(a),!0).forEach((function(t){Object(N.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ce(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var le=function(e){var t=e.api,a=Object(n.useState)(),c=Object(d.a)(a,2),s=c[0],l=c[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(m.a.mark((function e(){var a,n,r,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.get("/members").then((function(e){return e.data})),t.get("/groups").then((function(e){return e.data}))]);case 2:a=e.sent,n=Object(d.a)(a,2),r=n[0],c=n[1],l({members:r,groups:c});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s||function(){e.apply(this,arguments)}()}),[t,s]);var o=function(){var e=Object(u.a)(m.a.mark((function e(){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/members",{headers:{Accept:"text/csv"}});case 2:a=e.sent,(n=document.createElement("a")).style.display="none",document.body.appendChild(n),n.href=window.URL.createObjectURL(new Blob([a.data],{type:"text/csv"})),n.setAttribute("download","members.csv"),n.click(),window.URL.revokeObjectURL(n.href),document.body.removeChild(n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h1",{className:"h3 mb-2 text-gray-800"},"Members"),r.a.createElement("p",{className:"mb-4"},"Create and manage members."),r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Export")),r.a.createElement("div",{className:"card-body"},r.a.createElement("p",null,"Export all members as CSV"),r.a.createElement("p",null,r.a.createElement("button",{className:"btn btn-primary",onClick:o},"Export")," "))),r.a.createElement(ee,{api:t,addMembers:function(e){s.members.data=s.members.data.concat(e.data),s.members.links=se({},e.links,{},s.members.links),l(se({},s))},groups:s?s.groups.data:[]}),r.a.createElement(re,{api:t,removeMembers:function(e){s.members.data=s.members.data.filter((function(t){return!e.some((function(e){return t.id===e.id}))})),l(se({},s))},groups:s?s.groups.data:[],members:s?s.members.data:[],links:s?s.members.links:{}}))},oe=function(e){var t=e.api,a=e.onJourneysUploaded,c=Object(n.useRef)(null),s=Object(n.useState)(""),l=Object(d.a)(s,2),o=l[0],i=l[1],p=function(){var e=Object(u.a)(m.a.mark((function e(n){var r,s,l,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),c.current.files[0]){e.next=3;break}return e.abrupt("return",i("Please select a CSV file"));case 3:return e.prev=3,(r=new FormData).append("file",c.current.files[0],"upload.csv"),s={"Content-Type":"multipart/form-data"},e.next=9,t.post("/journeys",r,{headers:s}).then((function(e){return e.data.data.errors}));case 9:l=e.sent,o=0===l.length?"Upload successful":l.join("\n"),i(o),a(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),i("Error while uploading journeys.");case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Upload")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{className:"table-responsive",onSubmit:p,style:{maxWidth:"650px"}},r.a.createElement("p",null,o),r.a.createElement("input",{type:"file",name:"uploadFile",ref:c}),r.a.createElement("button",{style:{width:"100px",marginTop:"20px"},type:"submit",className:"btn btn-primary btn-user btn-block"},"Upload"))))};function ie(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var me=function(e){var t=e.api,a=e.journeys.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(a),!0).forEach((function(t){Object(N.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ie(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{name:e.memberId,id:e.memberId,numeric_id:e.memberId.substr(8),uploaded:new Date(e.uploaded+"+0000").toLocaleString(),travelDate:new Date(e.travelDate+"+0000").toLocaleString(),processed:null===e.processed?"Pending":new Date(e.processed+"+0000").toLocaleString(),carbonSaving:null===e.carbonSaving?"-":e.carbonSaving+"kg",distance:null===e.distance?"-":e.distance+" miles",rewardsEarned:null===e.rewardsEarned?"-":e.rewardsEarned})}));return r.a.createElement(T,{columns:[{name:"Member ID",selector:"numeric_id",sortable:!0},{name:"Source",selector:"source",sortable:!0,width:"110px"},{name:"Device",selector:"deviceId",sortable:!0,width:"110px"},{name:"Uploaded",selector:"uploaded",sortable:!0,width:"170px"},{name:"Processed",selector:"processed",sortable:!0,width:"170px"},{name:"Travel Date",selector:"travelDate",sortable:!0,width:"170px"},{name:"Distance",selector:"distance",sortable:!0,width:"90px"},{name:"Mode",selector:"mode",sortable:!0,width:"90px"},{name:"Rewards Earned",selector:"rewardsEarned",sortable:!0,width:"140px"},{name:"Carbon Saving",selector:"carbonSaving",sortable:!0,width:"140px"}],rows:a,api:t})},ue=function(e){var t=e.api,a=Object(n.useState)(),c=Object(d.a)(a,2),s=c[0],l=c[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(m.a.mark((function e(){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/journeys").then((function(e){return e.data}));case 2:a=e.sent,l({journeys:a});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s||function(){e.apply(this,arguments)}()}),[t,s]);var o=function(){var e=Object(u.a)(m.a.mark((function e(){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/journeys",{headers:{Accept:"text/csv"}});case 2:a=e.sent,(n=document.createElement("a")).style.display="none",document.body.appendChild(n),n.href=window.URL.createObjectURL(new Blob([a.data],{type:"text/csv"})),n.setAttribute("download","members.csv"),n.click(),window.URL.revokeObjectURL(n.href),document.body.removeChild(n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h1",{className:"h3 mb-2 text-gray-800"},"Journeys"),r.a.createElement("p",{className:"mb-4"},"View, upload and export member journeys."),r.a.createElement("div",{className:"card shadow mb-4"},r.a.createElement("div",{className:"card-header py-3"},r.a.createElement("h6",{className:"m-0 font-weight-bold text-primary"},"Export")),r.a.createElement("div",{className:"card-body"},r.a.createElement("p",null,"Export all member journeys as CSV"),r.a.createElement("p",null,r.a.createElement("button",{className:"btn btn-primary",onClick:o},"Export")," "))),r.a.createElement(oe,{api:t,onJourneysUploaded:function(){l(null)}}),r.a.createElement(me,{api:t,journeys:s?s.journeys.data:[]}))},de=function(e){var t=e.api,a=e.statuses.map((function(e,t){return{id:t+"",name:e.deviceId,numeric_id:e.deviceId,received:new Date(e.received+"+0000").toLocaleString(),status:e.status}}));return r.a.createElement(T,{columns:[{name:"Device ID",selector:"numeric_id",sortable:!0,width:"110px"},{name:"Received",selector:"received",sortable:!0,width:"180px"},{name:"Status",selector:"status",sortable:!1}],rows:a,api:t})},pe=function(e){var t=e.api,a=Object(n.useState)(),c=Object(d.a)(a,2),s=c[0],l=c[1];return Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(m.a.mark((function e(){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/devices").then((function(e){return e.data}));case 2:a=e.sent,l({statuses:a});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}s||function(){e.apply(this,arguments)}()}),[t,s]),r.a.createElement("div",{className:"container-fluid"},r.a.createElement("h1",{className:"h3 mb-2 text-gray-800"},"Device Status"),r.a.createElement("p",{className:"mb-4"},"View status messages from devices connected to The Things Network."),r.a.createElement(de,{api:t,statuses:s?s.statuses.data:[]}))},be=function(e){var t=e.auth;return r.a.createElement("div",{id:"wrapper"},r.a.createElement(y,null),r.a.createElement("div",{id:"content-wrapper",className:"d-flex flex-column"},r.a.createElement("div",{id:"content"},r.a.createElement(j,{auth:t}),r.a.createElement(l.a,null,r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"/schemes"},r.a.createElement(W,{api:t.getAuthenticatedApi()})),r.a.createElement(o.b,{path:"/organisations"},r.a.createElement(H,{api:t.getAuthenticatedApi()})),r.a.createElement(o.b,{path:"/groups"},r.a.createElement(X,{api:t.getAuthenticatedApi()})),r.a.createElement(o.b,{path:"/members"},r.a.createElement(le,{api:t.getAuthenticatedApi()})),r.a.createElement(o.b,{path:"/journeys"},r.a.createElement(ue,{api:t.getAuthenticatedApi()})),r.a.createElement(o.b,{path:"/devices"},r.a.createElement(pe,{api:t.getAuthenticatedApi()})),r.a.createElement(o.b,{path:"/"},r.a.createElement(O,{api:t.getAuthenticatedApi()}))))),r.a.createElement(w,null)))},fe=a(192),he=function(e){var t=e.children,a=e.auth,n=Object(fe.a)(e,["children","auth"]);return r.a.createElement(o.b,Object.assign({},n,{render:function(e){var n=e.location;return a.isAuthenticated?t:r.a.createElement(o.a,{to:{pathname:"/login",state:{from:n}}})}}))},ve=a(193),Ee=a(194),ge=a(454),Oe=a(69),ye=a.n(Oe),je=function(){function e(t){Object(ve.a)(this,e),this.api=t,this.cookie=void 0,this.setCookie=void 0,this.removeCookie=void 0,this.authenticatedApi=void 0;var a=Object(ge.a)(["auth"]),n=Object(d.a)(a,3),r=n[0],c=n[1],s=n[2];this.cookie=r.auth,this.setCookie=c,this.removeCookie=s,this.authenticatedApi=ye.a.create({baseURL:t.defaults.baseURL,headers:{authorization:"Basic "+(this.cookie&&this.cookie.token)}})}return Object(Ee.a)(e,[{key:"login",value:function(){var e=Object(u.a)(m.a.mark((function e(t,a){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.api.post("/login",{username:t,password:a});case 3:n=e.sent,this.setCookie("auth",n.data.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"logout",value:function(){this.removeCookie("auth")}},{key:"getAuthenticatedApi",value:function(){return this.authenticatedApi}},{key:"getName",value:function(){return this.cookie.name}},{key:"isAuthenticated",get:function(){return this.cookie&&void 0!==this.cookie.token}}]),e}(),we=(a(448),a(449),function(e){var t=e.groups,a=e.links,c=(e.group,e.setGroup),s=Object(n.useState)(""),l=Object(d.a)(s,2),o=l[0],i=l[1],m=Object(n.useState)(""),u=Object(d.a)(m,2),p=u[0],b=u[1],f=Object.keys(a).filter((function(e){return e.startsWith("/scheme/")&&"/scheme/1"!==e})).map((function(e){return a[e]})),h=Object.keys(a).filter((function(e){return e.startsWith("/organisation/")&&a[e].scheme===o})).map((function(e){return a[e]})),v=t.filter((function(e){return e.organisation===p}));return r.a.createElement("div",{className:"group-select"},r.a.createElement("select",{className:"custom-select form-control form-control-sm",name:"scheme",onChange:function(e){return i(e.target.value)}},r.a.createElement("option",{value:""},"<Select scheme>"),f.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}))),r.a.createElement("select",{disabled:0===h.length,className:"custom-select form-control form-control-sm",name:"organisation",onChange:function(e){return b(e.target.value)}},r.a.createElement("option",{value:""},"<Select organisation>"),h.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}))),r.a.createElement("select",{disabled:0===v.length,className:"custom-select form-control form-control-sm",name:"group",onChange:function(e){return c(e.target.value)}},r.a.createElement("option",{value:""},"<Select group>"),v.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}))))}),Ne=function(e){var t=e.api,a=Object(n.useState)(!1),c=Object(d.a)(a,2),s=c[0],l=c[1],o=Object(n.useState)(""),i=Object(d.a)(o,2),p=i[0],b=i[1],f=Object(n.useState)(""),h=Object(d.a)(f,2),v=h[0],E=h[1],g=Object(n.useState)(""),O=Object(d.a)(g,2),y=O[0],j=O[1],w=Object(n.useState)(1),N=Object(d.a)(w,2),x=N[0],k=N[1],S=Object(n.useState)(""),C=Object(d.a)(S,2),D=C[0],P=C[1],M=Object(n.useState)([]),T=Object(d.a)(M,2),R=T[0],A=T[1],L=Object(n.useState)({}),I=Object(d.a)(L,2),U=I[0],W=I[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(m.a.mark((function e(){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("/groups");case 2:a=e.sent,A(a.data.data),W(a.data.links);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}0===R.length&&function(){e.apply(this,arguments)}()}),[t,R]);var G=function(){var e=Object(u.a)(m.a.mark((function e(a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,t.post("/member",{smartcard:v,defaultTransportMode:y,defaultDistance:x,group:D});case 4:l(!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),b("Unable to register, please try again.");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),F=(16===v.length||18===v.length)&&""!==y&&x>0&&""!==D;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-xl-10 col-lg-12 col-md-9"},r.a.createElement("div",{className:"card o-hidden border-0 shadow-lg my-5"},r.a.createElement("div",{className:"card-body p-0"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-lg-6 d-none d-lg-block bg-login-image"}),r.a.createElement("div",{className:"col-lg-6"},r.a.createElement("div",{className:"p-5"},s?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"text-center"},r.a.createElement("h1",{className:"h4 text-gray-900 mb-4"},"SUCCESS - Your card has been registered!")),r.a.createElement("p",null,"Thank you."),r.a.createElement("p",null,"Using your smartcard to report green travel choices will now add points and carbon savings to your account. For more information and to access Eco Rewards, go to ",r.a.createElement("a",{href:"https://www.ecorewards.org.uk"},"ecorewards.org.uk")," create your personal account."),r.a.createElement("br",null)):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"text-center"},r.a.createElement("h1",{className:"h4 text-gray-900 mb-4"},"Register")),r.a.createElement("form",{className:"user"},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control form-control-user",id:"exampleInputSmartcard",pattern:"^[0-9]*$",minLength:16,maxLength:18,"aria-describedby":"smartcardHelp",placeholder:"Enter Smartcard number",required:!0,onChange:function(e){return E(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement(Z,{defaultTransportMode:y,setDefaultTransportMode:j})),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control form-control-user",id:"exampleInputDistance","aria-describedby":"distanceHelp",placeholder:"Enter normal distance in miles",required:!0,onChange:function(e){return k(+e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement(we,{group:D,setGroup:P,groups:R,links:U})),r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-user btn-block",onClick:G,disabled:!F},"Register")),p&&r.a.createElement("hr",null),p)))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(450),a(451);s.a.render(r.a.createElement((function(){var e=ye.a.create({baseURL:"https://api.ecorewards.co.uk"}),t=new je(e);return r.a.createElement(l.a,null,r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"/login"},r.a.createElement(p,{auth:t})),r.a.createElement(o.b,{path:"/register"},r.a.createElement(Ne,{api:e})),r.a.createElement(he,{auth:t,path:"/"},r.a.createElement(be,{auth:t}))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[223,1,2]]]);
//# sourceMappingURL=main.33c15e59.chunk.js.map